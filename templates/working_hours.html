{% extends "base.html" %}

{% block content %}
<div style="max-width: 900px; margin: 0 auto;">
    <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 style="color: var(--primary-color); margin: 0;">‚öôÔ∏è Configurar Hor√°rios</h2>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary" style="padding: 8px 15px; font-size: 14px;">Voltar</a>
        </div>
        <p style="color: #666;">Defina os turnos de trabalho (Manh√£ e Tarde). O intervalo entre eles ser√° o almo√ßo.</p>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

        <form method="POST">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9fa; text-align: left;">
                        <th style="padding: 10px;">Dia</th>
                        <th style="padding: 10px;">Status</th>
                        <th style="padding: 10px;">Turno 1 (Manh√£)</th>
                        <th style="padding: 10px;">Turno 2 (Tarde)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for day in days_data %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 15px 10px; font-weight: 600;">{{ day.name }}</td>
                        
                        <td style="padding: 10px;">
                            <label style="cursor: pointer;">
                                <input type="checkbox" name="closed_{{ day.id }}" 
                                       id="closed_{{ day.id }}" 
                                       {% if day.is_closed %}checked{% endif %}
                                       onchange="toggleDay({{ day.id }})"> 
                                Fechado
                            </label>
                        </td>

                        <td style="padding: 10px;">
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <input type="time" name="start1_{{ day.id }}" id="start1_{{ day.id }}" value="{{ day.s1 }}" style="margin:0; width: 90px;">
                                <span>at√©</span>
                                <input type="time" name="end1_{{ day.id }}" id="end1_{{ day.id }}" value="{{ day.e1 }}" style="margin:0; width: 90px;">
                            </div>
                        </td>

                        <td style="padding: 10px;">
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <input type="time" name="start2_{{ day.id }}" id="start2_{{ day.id }}" value="{{ day.s2 }}" style="margin:0; width: 90px;">
                                <span>at√©</span>
                                <input type="time" name="end2_{{ day.id }}" id="end2_{{ day.id }}" value="{{ day.e2 }}" style="margin:0; width: 90px;">
                            </div>
                        </td>
                    </tr>
                    <script>
                        window.addEventListener('load', function() { toggleDay({{ day.id }}); });
                    </script>
                    {% endfor %}
                </tbody>
            </table>

            <div style="margin-top: 30px; text-align: right;">
                <button type="submit" class="btn btn-primary" style="padding: 12px 30px; font-size: 16px;">üíæ Salvar Hor√°rios</button>
            </div>
        </form>
    </div>
</div>

<script>
function toggleDay(id) {
    const isClosed = document.getElementById('closed_' + id).checked;
    const inputs = ['start1_', 'end1_', 'start2_', 'end2_'];
    
    inputs.forEach(prefix => {
        const el = document.getElementById(prefix + id);
        if(el) {
            el.disabled = isClosed;
            if(isClosed) el.style.backgroundColor = "#f0f0f0";
            else el.style.backgroundColor = "white";
        }
    });
}
</script>
{% endblock %}